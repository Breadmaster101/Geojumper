<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geojumper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Explorer's Journal Theme */
            --font-body: 'Merriweather', serif;
            --font-heading: 'Roboto Condensed', sans-serif;
            --bg-main: #fdfaf0;
            --bg-secondary: #f3efe2;
            --bg-inset: #ede6d5;
            --text-primary: #3d3522;
            --text-secondary: #8c7e6a;
            --border-color: #dcd2b8;
            --accent-primary: #005f73;
            --accent-primary-hover: #004c5c;
            --accent-secondary: #9b2226;
            --accent-win: #2d6a4f;
            --accent-win-text: #f1f1f1;
            --white: #ffffff;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        @keyframes value-pop {
            0% { transform: scale(0.9); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1.0); opacity: 1; }
        }

        @keyframes fade-in-right {
            from {
                opacity: 0;
                transform: translateX(-15px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        html {
            box-sizing: border-box;
            /* CHANGED: Removed overflow: hidden to allow scrolling if needed */
        }

        *, *:before, *:after {
            box-sizing: inherit;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-main);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center; 
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
            /* CHANGED: Added padding-bottom to shift the content up slightly */
            padding-bottom: 10vh;
            /* CHANGED: Allowed vertical scrolling if content overflows */
            overflow-y: auto; 
        }
        
        .icon {
            width: 24px;
            height: 24px;
            stroke-width: 1.5;
            vertical-align: middle;
            margin-right: 8px;
            color: var(--text-secondary);
        }

        #game-container {
            width: 100%;
            max-width: 800px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px -10px var(--shadow-color);
            padding: 30px 40px;
            text-align: center;
            transition: all 0.3s ease;
            margin: 20px;
        }

        h1 {
            font-family: var(--font-heading);
            color: var(--text-primary);
            font-size: 2.5em;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin: 0 0 5px 0;
        }

        p.subtitle {
            font-size: 1.1em;
            color: var(--text-secondary);
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        #mission {
            background: var(--bg-inset);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-color);
            font-family: var(--font-heading);
        }

        #mission .country-name {
            font-weight: bold;
        }
        #mission .start { color: var(--accent-win); }
        #mission .target { color: var(--accent-secondary); }
        
        #mission .arrow {
            color: var(--text-secondary);
            margin: 0 20px;
            font-size: 1.5em;
            line-height: 1;
        }

        #game-state {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        #game-state > div {
            background: var(--bg-main);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        #game-state .label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.9em;
            margin-bottom: 8px;
            font-family: var(--font-heading);
            text-transform: uppercase;
        }

        #game-state .value {
            font-size: 1.8em;
            font-weight: bold;
            font-family: var(--font-body);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #game-state .value.value-update {
            animation: value-pop 0.3s ease-out;
        }

        #current-country-name { color: var(--accent-primary); }
        #jumps-count { color: var(--text-primary); }
        #optimal-jumps { color: var(--text-primary); }

        #path-history-container h3 {
            font-family: var(--font-heading);
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            font-size: 1em;
            margin-bottom: 15px;
        }

        #path-history-list {
            list-style-type: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0 10px;
            margin: 10px 0;
            min-height: 40px;
            align-items: center;
        }

        #path-history-list li {
            background: var(--bg-inset);
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            position: relative;
        }
        
        #path-history-list li.new-item {
            animation: fade-in-right 0.4s ease-out;
        }

        #path-history-list .arrow {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5em;
            padding: 0;
        }

        #neighbors-container h2 {
            font-family: var(--font-heading);
            color: var(--text-primary);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #neighbors-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            padding: 0;
            list-style-type: none;
        }
        
        .stuck-message {
            color: var(--text-secondary);
            font-style: italic;
            padding: 10px;
            background-color: var(--bg-inset);
            border-radius: 5px;
            border: 1px dashed var(--border-color);
        }

        .neighbor-btn {
            background-color: var(--accent-primary);
            color: var(--white);
            border: none;
            border-radius: 5px;
            padding: 12px 20px;
            font-size: 1em;
            font-family: var(--font-body);
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            box-shadow: 0 4px 6px -1px var(--shadow-color);
        }

        .neighbor-btn:hover {
            background-color: var(--accent-primary-hover);
            transform: translateY(-2px);
        }
        
        .neighbor-btn:disabled {
             background-color: var(--text-secondary);
             color: var(--bg-main);
             cursor: not-allowed;
             transform: none;
             box-shadow: none;
             opacity: 0.7;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        /* --- CHANGED: Created a single class for both secondary action buttons --- */
        .action-button-secondary {
            background-color: transparent;
            color: var(--accent-secondary);
            border: 1px solid var(--accent-secondary);
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: bold;
            text-transform: uppercase;
            font-family: var(--font-heading);
        }

        .action-button-secondary:hover {
            background-color: var(--accent-secondary);
            color: var(--white);
        }
        
        /* --- Win Screen --- */
        #win-screen {
            display: none; /* Hidden by default */
            padding: 40px;
            background: var(--accent-win);
            color: var(--accent-win-text);
            border-radius: 8px;
        }
        
        #win-screen h2 {
            font-family: var(--font-heading);
            color: var(--accent-win-text);
            font-size: 2.5em;
            text-transform: uppercase;
            letter-spacing: 2px;
            border: none;
        }
        #win-screen p { color: inherit; opacity: 0.9; }

        #path-list {
            list-style-type: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px 10px;
            margin: 20px 0;
        }
        
        #path-list li {
            background: rgba(255,255,255,0.15);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        #path-list .arrow {
            background: transparent;
            align-self: center;
        }

        #reset-btn {
            background-color: var(--bg-main);
            color: var(--accent-win);
            border: none;
            border-radius: 5px;
            padding: 14px 30px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: bold;
            font-family: var(--font-heading);
            text-transform: uppercase;
        }
        
        #reset-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    
    <svg width="0" height="0" style="position:absolute">
        <symbol id="icon-location" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle>
        </symbol>
        <symbol id="icon-jumps" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline>
        </symbol>
        <symbol id="icon-optimal" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle>
        </symbol>
    </svg>

    <div id="game-container">
        <h1>Geojumper</h1>
        <p class="subtitle">Chart your course from the start country to the target nation by navigating through their bordering neighbors.</p>

        <div id="mission">
            <span id="start-country" class="country-name start"></span>
            <span class="arrow">&rarr;</span>
            <span id="target-country" class="country-name target"></span>
        </div>

        <div id="game-state">
            <div>
                <span class="label">Current Location</span>
                <span id="current-country-name" class="value">
                    <svg class="icon"><use href="#icon-location" /></svg>
                    <span>-</span>
                </span>
            </div>
            <div>
                <span class="label">Jumps Taken</span>
                <span id="jumps-count" class="value">
                    <svg class="icon"><use href="#icon-jumps" /></svg>
                    <span>0</span>
                </span>
            </div>
            <div>
                <span class="label">Optimal Jumps</span>
                <span id="optimal-jumps" class="value">
                     <svg class="icon"><use href="#icon-optimal" /></svg>
                    <span>-</span>
                </span>
            </div>
        </div>

        <div id="path-history-container">
             <h3>Your Current Path:</h3>
             <ul id="path-history-list"></ul>
        </div>

        <div id="neighbors-container">
            <h2>Choose a Neighboring Country</h2>
            <ul id="neighbors-list"></ul>
            <div class="action-buttons">
                <!-- CHANGED: Both buttons now use the same class for styling -->
                <button id="restart-btn" class="action-button-secondary">Restart Journey</button>
                <button id="skip-btn" class="action-button-secondary">Skip Mission</button>
            </div>
        </div>
        
        <div id="win-screen">
            <h2>Mission Accomplished!</h2>
            <p id="win-message"></p>
            <p>Your Final Path:</p>
            <ul id="path-list"></ul>
            <p id="optimal-path-info"></p>
            <button id="reset-btn">New Mission</button>
        </div>

    </div>

    <script>
        // --- DATA ---
        const countryBorders = { "Afghanistan": ["Iran", "Pakistan", "Turkmenistan", "Uzbekistan", "Tajikistan", "China"], "Albania": ["Montenegro", "Kosovo", "North Macedonia", "Greece"], "Algeria": ["Morocco", "Western Sahara", "Mauritania", "Mali", "Niger", "Libya", "Tunisia"], "Andorra": ["France", "Spain"], "Angola": ["Congo", "DR Congo", "Zambia", "Namibia"], "Argentina": ["Chile", "Bolivia", "Paraguay", "Brazil", "Uruguay"], "Armenia": ["Georgia", "Azerbaijan", "Iran", "Turkey"], "Austria": ["Germany", "Czech Republic", "Slovakia", "Hungary", "Slovenia", "Italy", "Switzerland", "Liechtenstein"], "Azerbaijan": ["Russia", "Georgia", "Armenia", "Iran", "Turkey"], "Bangladesh": ["India", "Myanmar"], "Belarus": ["Russia", "Ukraine", "Poland", "Lithuania", "Latvia"], "Belgium": ["Netherlands", "Germany", "Luxembourg", "France"], "Belize": ["Mexico", "Guatemala"], "Benin": ["Togo", "Burkina Faso", "Niger", "Nigeria"], "Bhutan": ["China", "India"], "Bolivia": ["Peru", "Brazil", "Paraguay", "Argentina", "Chile"], "Bosnia and Herzegovina": ["Croatia", "Serbia", "Montenegro"], "Botswana": ["Namibia", "South Africa", "Zimbabwe", "Zambia"], "Brazil": ["Argentina", "Bolivia", "Colombia", "French Guiana", "Guyana", "Paraguay", "Peru", "Suriname", "Uruguay", "Venezuela"], "Bulgaria": ["Romania", "Serbia", "North Macedonia", "Greece", "Turkey"], "Burkina Faso": ["Mali", "Niger", "Benin", "Togo", "Ghana", "Ivory Coast"], "Burundi": ["Rwanda", "Tanzania", "DR Congo"], "Cambodia": ["Thailand", "Laos", "Vietnam"], "Cameroon": ["Nigeria", "Chad", "Central African Republic", "Congo", "Gabon", "Equatorial Guinea"], "Canada": ["United States"], "Central African Republic": ["Cameroon", "Chad", "Sudan", "South Sudan", "DR Congo", "Congo"], "Chad": ["Libya", "Sudan", "Central African Republic", "Cameroon", "Nigeria", "Niger"], "Chile": ["Argentina", "Bolivia", "Peru"], "China": ["Afghanistan", "Bhutan", "India", "Kazakhstan", "Kyrgyzstan", "Laos", "Mongolia", "Myanmar", "Nepal", "North Korea", "Pakistan", "Russia", "Tajikistan", "Vietnam"], "Colombia": ["Brazil", "Ecuador", "Panama", "Peru", "Venezuela"], "Congo": ["Angola", "Cameroon", "Central African Republic", "DR Congo", "Gabon"], "Costa Rica": ["Nicaragua", "Panama"], "Croatia": ["Slovenia", "Hungary", "Serbia", "Bosnia and Herzegovina", "Montenegro"], "Cuba": ["United States"], "Czech Republic": ["Germany", "Poland", "Slovakia", "Austria"], "DR Congo": ["Angola", "Burundi", "Central African Republic", "Congo", "Rwanda", "South Sudan", "Tanzania", "Uganda", "Zambia"], "Denmark": ["Germany"], "Djibouti": ["Eritrea", "Ethiopia", "Somalia"], "Dominican Republic": ["Haiti"], "Ecuador": ["Colombia", "Peru"], "Egypt": ["Libya", "Sudan", "Israel"], "El Salvador": ["Guatemala", "Honduras"], "Equatorial Guinea": ["Cameroon", "Gabon"], "Eritrea": ["Sudan", "Ethiopia", "Djibouti"], "Estonia": ["Latvia", "Russia"], "Eswatini": ["South Africa", "Mozambique"], "Ethiopia": ["Djibouti", "Eritrea", "Kenya", "Somalia", "South Sudan", "Sudan"], "Finland": ["Norway", "Sweden", "Russia"], "France": ["Andorra", "Belgium", "Germany", "Italy", "Luxembourg", "Monaco", "Spain", "Switzerland"], "French Guiana": ["Suriname", "Brazil"], "Gabon": ["Equatorial Guinea", "Cameroon", "Congo"], "Gambia": ["Senegal"], "Georgia": ["Russia", "Turkey", "Armenia", "Azerbaijan"], "Germany": ["Austria", "Belgium", "Czech Republic", "Denmark", "France", "Luxembourg", "Netherlands", "Poland", "Switzerland"], "Ghana": ["Burkina Faso", "Ivory Coast", "Togo"], "Greece": ["Albania", "Bulgaria", "Turkey", "North Macedonia"], "Guatemala": ["Mexico", "Belize", "Honduras", "El Salvador"], "Guinea": ["Guinea-Bissau", "Senegal", "Mali", "Ivory Coast", "Liberia", "Sierra Leone"], "Guinea-Bissau": ["Guinea", "Senegal"], "Guyana": ["Brazil", "Suriname", "Venezuela"], "Haiti": ["Dominican Republic"], "Honduras": ["Guatemala", "El Salvador", "Nicaragua"], "Hungary": ["Austria", "Croatia", "Romania", "Serbia", "Slovakia", "Slovenia", "Ukraine"], "India": ["Bangladesh", "Bhutan", "China", "Myanmar", "Nepal", "Pakistan"], "Indonesia": ["Malaysia", "Papua New Guinea", "Timor-Leste"], "Iran": ["Afghanistan", "Armenia", "Azerbaijan", "Iraq", "Pakistan", "Turkey", "Turkmenistan"], "Iraq": ["Iran", "Jordan", "Kuwait", "Saudi Arabia", "Syria", "Turkey"], "Ireland": ["United Kingdom"], "Israel": ["Egypt", "Jordan", "Lebanon", "Syria"], "Italy": ["Austria", "France", "San Marino", "Slovenia", "Switzerland", "Vatican City"], "Ivory Coast": ["Burkina Faso", "Ghana", "Guinea", "Liberia", "Mali"], "Jordan": ["Iraq", "Israel", "Saudi Arabia", "Syria"], "Kazakhstan": ["China", "Kyrgyzstan", "Russia", "Turkmenistan", "Uzbekistan"], "Kenya": ["Ethiopia", "Somalia", "South Sudan", "Tanzania", "Uganda"], "Kosovo": ["Albania", "Montenegro", "North Macedonia", "Serbia"], "Kuwait": ["Iraq", "Saudi Arabia"], "Kyrgyzstan": ["China", "Kazakhstan", "Tajikistan", "Uzbekistan"], "Laos": ["Myanmar", "Cambodia", "China", "Thailand", "Vietnam"], "Latvia": ["Belarus", "Estonia", "Lithuania", "Russia"], "Lebanon": ["Israel", "Syria"], "Lesotho": ["South Africa"], "Liberia": ["Guinea", "Ivory Coast", "Sierra Leone"], "Libya": ["Algeria", "Chad", "Egypt", "Niger", "Sudan", "Tunisia"], "Liechtenstein": ["Austria", "Switzerland"], "Lithuania": ["Belarus", "Latvia", "Poland", "Russia"], "Luxembourg": ["Belgium", "France", "Germany"], "Madagascar": [], "Malawi": ["Mozambique", "Tanzania", "Zambia"], "Malaysia": ["Brunei", "Indonesia", "Thailand"], "Mali": ["Algeria", "Burkina Faso", "Guinea", "Ivory Coast", "Mauritania", "Niger", "Senegal"], "Mauritania": ["Algeria", "Mali", "Senegal", "Western Sahara"], "Mexico": ["Belize", "Guatemala", "United States"], "Moldova": ["Romania", "Ukraine"], "Monaco": ["France"], "Mongolia": ["China", "Russia"], "Montenegro": ["Albania", "Bosnia and Herzegovina", "Croatia", "Kosovo", "Serbia"], "Morocco": ["Algeria", "Western Sahara", "Spain"], "Mozambique": ["Eswatini", "Malawi", "South Africa", "Tanzania", "Zambia", "Zimbabwe"], "Myanmar": ["Bangladesh", "China", "India", "Laos", "Thailand"], "Namibia": ["Angola", "Botswana", "South Africa", "Zambia"], "Nepal": ["China", "India"], "Netherlands": ["Belgium", "Germany"], "Nicaragua": ["Costa Rica", "Honduras"], "Niger": ["Algeria", "Benin", "Burkina Faso", "Chad", "Libya", "Mali", "Nigeria"], "Nigeria": ["Benin", "Cameroon", "Chad", "Niger"], "North Korea": ["China", "South Korea", "Russia"], "North Macedonia": ["Albania", "Bulgaria", "Greece", "Kosovo", "Serbia"], "Norway": ["Finland", "Sweden", "Russia"], "Oman": ["Saudi Arabia", "United Arab Emirates", "Yemen"], "Pakistan": ["Afghanistan", "China", "India", "Iran"], "Panama": ["Colombia", "Costa Rica"], "Papua New Guinea": ["Indonesia"], "Paraguay": ["Argentina", "Bolivia", "Brazil"], "Peru": ["Bolivia", "Brazil", "Chile", "Colombia", "Ecuador"], "Poland": ["Belarus", "Czech Republic", "Germany", "Lithuania", "Russia", "Slovakia", "Ukraine"], "Portugal": ["Spain"], "Qatar": ["Saudi Arabia"], "Romania": ["Bulgaria", "Hungary", "Moldova", "Serbia", "Ukraine"], "Russia": ["Azerbaijan", "Belarus", "China", "Estonia", "Finland", "Georgia", "Kazakhstan", "North Korea", "Latvia", "Lithuania", "Mongolia", "Norway", "Poland", "Ukraine"], "Rwanda": ["Burundi", "DR Congo", "Tanzania", "Uganda"], "San Marino": ["Italy"], "Saudi Arabia": ["Iraq", "Jordan", "Kuwait", "Oman", "Qatar", "United Arab Emirates", "Yemen"], "Senegal": ["Gambia", "Guinea", "Guinea-Bissau", "Mali", "Mauritania"], "Serbia": ["Bosnia and Herzegovina", "Bulgaria", "Croatia", "Hungary", "Kosovo", "Montenegro", "North Macedonia", "Romania"], "Sierra Leone": ["Guinea", "Liberia"], "Slovakia": ["Austria", "Czech Republic", "Hungary", "Poland", "Ukraine"], "Slovenia": ["Austria", "Croatia", "Italy", "Hungary"], "Somalia": ["Djibouti", "Ethiopia", "Kenya"], "South Africa": ["Botswana", "Eswatini", "Lesotho", "Mozambique", "Namibia", "Zimbabwe"], "South Korea": ["North Korea"], "South Sudan": ["Central African Republic", "DR Congo", "Ethiopia", "Kenya", "Sudan", "Uganda"], "Spain": ["Andorra", "France", "Gibraltar", "Portugal", "Morocco"], "Sudan": ["Central African Republic", "Chad", "Egypt", "Eritrea", "Ethiopia", "Libya", "South Sudan"], "Suriname": ["Brazil", "French Guiana", "Guyana"], "Sweden": ["Finland", "Norway"], "Switzerland": ["Austria", "France", "Germany", "Italy", "Liechtenstein"], "Syria": ["Iraq", "Israel", "Jordan", "Lebanon", "Turkey"], "Taiwan": ["China"], "Tajikistan": ["Afghanistan", "China", "Kyrgyzstan", "Uzbekistan"], "Tanzania": ["Burundi", "DR Congo", "Kenya", "Malawi", "Mozambique", "Rwanda", "Uganda", "Zambia"], "Thailand": ["Cambodia", "Laos", "Malaysia", "Myanmar"], "Timor-Leste": ["Indonesia"], "Togo": ["Benin", "Burkina Faso", "Ghana"], "Tunisia": ["Algeria", "Libya"], "Turkey": ["Armenia", "Azerbaijan", "Bulgaria", "Georgia", "Greece", "Iran", "Iraq", "Syria"], "Turkmenistan": ["Afghanistan", "Iran", "Kazakhstan", "Uzbekistan"], "Uganda": ["DR Congo", "Kenya", "Rwanda", "South Sudan", "Tanzania"], "Ukraine": ["Belarus", "Hungary", "Moldova", "Poland", "Romania", "Russia", "Slovakia"], "United Arab Emirates": ["Oman", "Saudi Arabia"], "United Kingdom": ["Ireland"], "United States": ["Canada", "Mexico", "Cuba"], "Uruguay": ["Argentina", "Brazil"], "Uzbekistan": ["Afghanistan", "Kazakhstan", "Kyrgyzstan", "Tajikistan", "Turkmenistan"], "Vatican City": ["Italy"], "Venezuela": ["Brazil", "Colombia", "Guyana"], "Vietnam": ["Cambodia", "China", "Laos"], "Western Sahara": ["Algeria", "Mauritania", "Morocco"], "Yemen": ["Oman", "Saudi Arabia"], "Zambia": ["Angola", "Botswana", "DR Congo", "Malawi", "Mozambique", "Namibia", "Tanzania", "Zimbabwe"], "Zimbabwe": ["Botswana", "Mozambique", "South Africa", "Zambia"] };
        const countries = Object.keys(countryBorders);
        
        let startCountry, targetCountry, currentCountry, jumps, path, optimalJumps;

        const startCountryEl = document.getElementById('start-country');
        const targetCountryEl = document.getElementById('target-country');
        const currentCountryEl = document.getElementById('current-country-name').querySelector('span');
        const jumpsEl = document.getElementById('jumps-count').querySelector('span');
        const optimalJumpsEl = document.getElementById('optimal-jumps').querySelector('span');
        const neighborsListEl = document.getElementById('neighbors-list');
        const neighborsContainerEl = document.getElementById('neighbors-container');
        const winScreenEl = document.getElementById('win-screen');
        const winMessageEl = document.getElementById('win-message');
        const pathListEl = document.getElementById('path-list');
        const optimalPathInfoEl = document.getElementById('optimal-path-info');
        const resetBtn = document.getElementById('reset-btn');
        const restartBtn = document.getElementById('restart-btn');
        const skipBtn = document.getElementById('skip-btn');
        const pathHistoryListEl = document.getElementById('path-history-list');

        function findShortestPath(start, end) {
            if (start === end) return [start];
            let queue = [[start]];
            const visited = new Set([start]);

            while (queue.length > 0) {
                const path = queue.shift();
                const node = path[path.length - 1];
                if (node === end) return path;
                for (const neighbor of countryBorders[node] || []) {
                    if (!visited.has(neighbor)) {
                        visited.add(neighbor);
                        const newPath = [...path, neighbor];
                        queue.push(newPath);
                    }
                }
            }
            return null;
        }

        function getPlayableCountries() {
            return countries.filter(c => countryBorders[c] && countryBorders[c].length > 0);
        }

        function getRandomCountry(exclude = null) {
            const playableCountries = getPlayableCountries();
            let country;
            do {
                country = playableCountries[Math.floor(Math.random() * playableCountries.length)];
            } while (country === exclude);
            return country;
        }

        function startGame() {
            let shortestPath;
            do {
                startCountry = getRandomCountry();
                targetCountry = getRandomCountry(startCountry);
                shortestPath = findShortestPath(startCountry, targetCountry);
            } while (!shortestPath || shortestPath.length < 3 || shortestPath.length > 8);

            optimalJumps = shortestPath.length - 1;
            currentCountry = startCountry;
            jumps = 0;
            path = [startCountry];

            winScreenEl.style.display = 'none';
            neighborsContainerEl.style.display = 'block';
            
            updateUI();
        }

        function updateUI() {
            startCountryEl.textContent = startCountry;
            targetCountryEl.textContent = targetCountry;
            currentCountryEl.textContent = currentCountry;
            jumpsEl.textContent = jumps;
            optimalJumpsEl.textContent = optimalJumps;

            if (jumps > 0) {
                const jumpsValueEl = document.getElementById('jumps-count');
                const currentLocationValueEl = document.getElementById('current-country-name');

                jumpsValueEl.classList.add('value-update');
                currentLocationValueEl.classList.add('value-update');
                
                jumpsValueEl.addEventListener('animationend', () => jumpsValueEl.classList.remove('value-update'), { once: true });
                currentLocationValueEl.addEventListener('animationend', () => currentLocationValueEl.classList.remove('value-update'), { once: true });
            }

            renderNeighbors();
            renderPathHistory();
        }

        function renderNeighbors() {
            neighborsListEl.innerHTML = '';
            const neighbors = countryBorders[currentCountry] || [];
            
            if (neighbors.length === 0) {
                const li = document.createElement('li');
                li.textContent = "This is an island nation with no land borders! You're stuck.";
                li.className = 'stuck-message';
                neighborsListEl.appendChild(li);
                return; 
            }

            const unvisitedNeighbors = neighbors.filter(n => !path.includes(n));
            if (unvisitedNeighbors.length === 0) {
                const li = document.createElement('li');
                li.textContent = "You've hit a dead end! All neighbors have been visited. Use 'Restart Journey' to try another path.";
                li.className = 'stuck-message';
                neighborsListEl.appendChild(li);
                return; 
            }

            neighbors.sort().forEach(neighbor => {
                const btn = document.createElement('button');
                btn.textContent = neighbor;
                btn.className = 'neighbor-btn';
                if (path.includes(neighbor)) {
                    btn.disabled = true;
                }
                btn.onclick = () => selectNeighbor(neighbor);
                const li = document.createElement('li');
                li.appendChild(btn);
                neighborsListEl.appendChild(li);
            });
        }

        function renderPathHistory() {
            pathHistoryListEl.innerHTML = '';
            path.forEach((country, index) => {
                const li = document.createElement('li');
                li.textContent = country;
                pathHistoryListEl.appendChild(li);
                
                if (index < path.length - 1) {
                    const arrow = document.createElement('li');
                    arrow.textContent = '→';
                    arrow.className = 'arrow';
                    pathHistoryListEl.appendChild(arrow);
                }
            });

            if (path.length > 1) {
                const listItems = pathHistoryListEl.querySelectorAll('li');
                const lastItem = listItems[listItems.length - 1]; 
                const secondLastItem = listItems[listItems.length - 2]; 
                
                lastItem.classList.add('new-item');
                secondLastItem.classList.add('new-item');
                
                lastItem.addEventListener('animationend', () => lastItem.classList.remove('new-item'), { once: true });
                secondLastItem.addEventListener('animationend', () => secondLastItem.classList.remove('new-item'), { once: true });
            }
        }

        function selectNeighbor(country) {
            if (countryBorders[currentCountry].includes(country) && !path.includes(country)) {
                currentCountry = country;
                jumps++;
                path.push(currentCountry);

                if (currentCountry === targetCountry) {
                    endGame();
                } else {
                    updateUI();
                }
            }
        }
        
        function endGame() {
            neighborsContainerEl.style.display = 'none';
            winScreenEl.style.display = 'block';
            
            let message = `You reached ${targetCountry} in ${jumps} jumps!`;
            if (jumps === optimalJumps) {
                message += " A perfect, optimal route!";
            } else if (jumps < optimalJumps) {
                message += " You found a route shorter than expected! Wow!";
            } else {
                message += ` The optimal path was ${optimalJumps} jumps.`
            }
            winMessageEl.textContent = message;
            
            pathListEl.innerHTML = '';
            path.forEach((country, index) => {
                const li = document.createElement('li');
                li.textContent = country;
                pathListEl.appendChild(li);
                
                if (index < path.length - 1) {
                    const arrow = document.createElement('li');
                    arrow.textContent = '→';
                    arrow.className = 'arrow';
                    pathListEl.appendChild(arrow);
                }
            });

            const optimalPath = findShortestPath(startCountry, targetCountry);
            optimalPathInfoEl.textContent = `Optimal Path: ${optimalPath.join(' → ')}`;
        }

        function restartJourney() {
            currentCountry = startCountry;
            jumps = 0;
            path = [startCountry];
            updateUI();
        }

        resetBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', restartJourney);
        skipBtn.addEventListener('click', startGame);

        startGame();

    </script>
</body>
</html>